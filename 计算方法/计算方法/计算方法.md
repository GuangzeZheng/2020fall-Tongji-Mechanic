# 实验一

用欧拉法和改进欧拉法求 $ y'=-y+ax+1$  （其中 $a=1+2rand(1)$），$y(0)=1$ 。并作图比较。

## 实验结果

![1](C:\Users\zgz\OneDrive\桌面\计算方法\1.png)

![2](C:\Users\zgz\OneDrive\桌面\计算方法\2.png)

通过比较，不难发现经过改进后欧拉法得到的结果优于初始结果，其原因在于欧拉法用差商 [y(xi+1)-y(xi)]/h 近似代替y(xi)的导数，局部截断误差较大；改进欧拉法先用欧拉法求出预报值，再利用梯形公式求出校正值，局部截断误差比欧拉法低了一阶，较大程度地提高了计算精度。

## 实验参数

![image-20210103232303382](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103232303382.png)

![image-20210103232340950](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103232340950.png)![image-20210103232356211](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103232356211.png)

## 实验代码

```matlab
clear;
rand('seed',1851960);
a = 1+2*rand(1);

f = @(x,y)a*x-y+1;
h = 0.1;
n = 1/h;
x = zeros(1,n+1);
y1 = zeros(1,n+1);              % 欧拉法
y2 = zeros(1,n+1);              % 改进欧拉法
x(1) = 0;
y1(1) = 1;
y2(1) = 1;
for k =1:n
    x(k+1) = x(1)+h*k;
    y1(k+1) = y1(k)+h*f(x(k),y1(k));
    y2(k+1) = y2(k)+h*f(x(k),y2(k));
    y2(k+1) = y2(k)+h/2*(f(x(k),y2(k))+f(x(k+1),y2(k+1)));
end
y3 = dsolve('Dy=b*x-y+1','y(0)=1','x');            % 精确解
y3 = subs(y3,'b',a);
y3 = subs(y3,'x',x);
figure(1);

plot(x,y1,'--','linewidth',2)
hold on
plot(x,y2,'-.','linewidth',2)
hold on
plot(x,y3,'-','linewidth',2)
legend('Euler','Euler+','exact')

xlabel('x');
ylabel('y');
grid on;


```

# 实验二

用龙格库塔方法求解 $y'=-ay+ax^2+ax$（其中 $a=randi(5,1,1)$），$0\le x\le0.5$  , $y(0)=1$。

## 实验结果

![4](C:\Users\zgz\OneDrive\桌面\计算方法\4.png)

可见在图示范围内，用龙格库塔方法求解的精度较高。

## 实验参数

![image-20210103234335225](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103234335225.png)

![image-20210103234437563](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103234437563.png)![image-20210103234449691](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103234449691.png)

## 实验代码

```matlab
clear;
rand('seed',1851960);
n=50;
x=zeros(1,n+1);
y=zeros(1,n+1);
x(1)=0;
y(1)=1;
h=0.01;
a=randi(5,1,1);

for i=1:n
    x(i+1)=x(i)+h;
    y(i+1)=runge_kutta(@f,x(i),y(i),h);
end

y2 = dsolve('Dy=-a*y+a*x*x+a*x','y(0)=1','x');            % 精确解
y2 = subs(y2,'a',a);
y2 = subs(y2,'x',x);

plot(x,y,'linewidth',2)
hold on
plot(x,y2,'-.','linewidth',2)
legend('Runge','exact')
```

```matlab
function y=runge_kutta(f,x,y,h)
k1=f(x,y);
k2=f(x+0.5*h,y+0.5*h*k1);
k3=f(x+0.5*h,y+0.5*h*k2);
k4=f(x+h,y+h*k3);
y=y+(1/6)*(k1+k2*2+2*k3+k4)*h;
```

```matlab
function f=f(x,y)
rand('seed',1851960)
a=randi(5,1,1);
f=-a*y+a*x*x+a*x;
```

# 实验三

棒球击出的速度为每秒30.48米，与水平线夹角为30度，球拍离地面0.9米，忽略空气和风力的阻力，球能否飞过离本垒60.96米远，10.67米高的围墙？需要多少时间？

## 实验结果

![7](C:\Users\zgz\OneDrive\桌面\计算方法\7.png)

由图可知，球无法飞过围墙，此过程经历的时间为：$t=\frac{60.96}{30.48\times0.5\sqrt{3}}s=2.31s$

## 实验参数

![image-20210103235642347](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103235642347.png)![image-20210103235656300](C:\Users\zgz\AppData\Roaming\Typora\typora-user-images\image-20210103235656300.png)

## 实验代码

```matlab
clear;
[x,y]=ode23('f2',[0,60.96],0.9);
y1=0*x+10.67;
plot(x,y,'linewidth',2)
hold on
plot(x,y1,'linewidth',2)
hold on
plot([60.96,60.96],ylim,'m--')
legend('ball','wall')
```

```matlab
function f=f2(x,y)
v0=30.48;g=9.8;
a=sin(pi/6)*v0;b=cos(pi/6)*v0;
f=a/b-g*x/b^2+0*y;
```

 